gather(
-1,
key = "組別", value = "元"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=元, color = 組別)
) +
scale_color_discrete(breaks = c("平均每戶可支配所得" ,
"可支配所得按戶數五等分位組-最高所得組",
"可支配所得按戶數五等分位組-次高所得組",
"可支配所得按戶數五等分位組-中間所得組",
"可支配所得按戶數五等分位組-次低所得組",
"可支配所得按戶數五等分位組-最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(title = element_text(hjust = 0.5))
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "元"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=元, color = 組別)
) +
scale_color_discrete(breaks = c("平均每戶可支配所得" ,
"可支配所得按戶數五等分位組-最高所得組",
"可支配所得按戶數五等分位組-次高所得組",
"可支配所得按戶數五等分位組-中間所得組",
"可支配所得按戶數五等分位組-次低所得組",
"可支配所得按戶數五等分位組-最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(title = element_text(vjust = 0.5,hjust = 0.5))
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "元"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=元, color = 組別)
) +
scale_color_discrete(breaks = c("平均每戶可支配所得" ,
"可支配所得按戶數五等分位組-最高所得組",
"可支配所得按戶數五等分位組-次高所得組",
"可支配所得按戶數五等分位組-中間所得組",
"可支配所得按戶數五等分位組-次低所得組",
"可支配所得按戶數五等分位組-最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動")
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_color_discrete(breaks = c("平均每戶可支配所得" ,
"可支配所得按戶數五等分位組-最高所得組",
"可支配所得按戶數五等分位組-次高所得組",
"可支配所得按戶數五等分位組-中間所得組",
"可支配所得按戶數五等分位組-次低所得組",
"可支配所得按戶數五等分位組-最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動")
colnames()
colnames(disposableIncome)
?rename
disposableIncome %>%
rename(
"年份",
"平均每戶可支配所得",
"最低所得組",
"次低所得組",
"中間所得組",
"次高所得組",
"最高所得組"
)
colnames(disposableIncome)
disposableIncome %>%
rename_(
"年份",
"平均每戶可支配所得",
"最低所得組",
"次低所得組",
"中間所得組",
"次高所得組",
"最高所得組"
)
disposableIncome %>%
rename(
年份 = "年份",
平均每戶可支配所得 = "平均每戶可支配所得",
可支配所得按戶數五等分位組-最低所得組 = "最低所得組",
disposableIncome %>%
rename(
年份 == "年份",
平均每戶可支配所得 == "平均每戶可支配所得",
可支配所得按戶數五等分位組-最低所得組 == "最低所得組",
可支配所得按戶數五等分位組-次低所得組 == "次低所得組",
可支配所得按戶數五等分位組-中間所得組 == "中間所得組",
可支配所得按戶數五等分位組-次高所得組 == "次高所得組",
可支配所得按戶數五等分位組-最高所得組 == "最高所得組"
)
disposableIncome %>%
rename(
年份 == "年份",
平均每戶可支配所得 == "平均每戶可支配所得",
`可支配所得按戶數五等分位組-最低所得組` == "最低所得組",
`可支配所得按戶數五等分位組-次低所得組` == "次低所得組",
`可支配所得按戶數五等分位組-中間所得組` == "中間所得組",
`可支配所得按戶數五等分位組-次高所得組` == "次高所得組",
`可支配所得按戶數五等分位組-最高所得組` == "最高所得組"
)
colnames(disposableIncome)[[3]]
colnames(disposableIncome)[[4]]
colnames(disposableIncome)[[5]]
colnames(disposableIncome)[[6]]
colnames(disposableIncome)[[7]]
disposableIncome %>%
.[-c(44:49),] -> disposableIncome
library(readr)
disposableIncome <- read_csv("https://www.dropbox.com/s/z80sbjw94cjex8x/disposableIncome.csv?dl=1",
locale = locale(encoding = "BIG5"), skip = 4)
library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)
colnames(disposableIncome)[[1]] <- "年份"
colnames(disposableIncome)[[3]] <- "最低所得組"
colnames(disposableIncome)[[4]] <- "次低所得組"
colnames(disposableIncome)[[5]] <- "中間所得組"
colnames(disposableIncome)[[6]] <- "次高所得組"
colnames(disposableIncome)[[7]] <- "最高所得組"
disposableIncome %>%
.[-c(44:49),] -> disposableIncome
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動")
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動")
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動")
"平均每戶可支配所得",
"平均每戶可支配所得",
"平均每戶可支配所得",
"平均每戶可支配所得",
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(vjust = 0.5)
)
"平均每戶可支配所得",
"平均每戶可支配所得",
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(hjust = 0.5)
)
"平均每戶可支配所得",
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(size = 2.5, hjust = 0.5)
)
"平均每戶可支配所得",
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(size = 40, hjust = 0.5)
)
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(size = 20, hjust = 0.5)
)
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(size = 18, hjust = 0.5)
)
library(readr)
disposableIncome <- read_csv("https://www.dropbox.com/s/z80sbjw94cjex8x/disposableIncome.csv?dl=1",
locale = locale(encoding = "BIG5"), skip = 4)
library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)
colnames(disposableIncome)[[1]] <- "年份"
colnames(disposableIncome)[[3]] <- "最低所得組"
colnames(disposableIncome)[[4]] <- "次低所得組"
colnames(disposableIncome)[[5]] <- "中間所得組"
colnames(disposableIncome)[[6]] <- "次高所得組"
colnames(disposableIncome)[[7]] <- "最高所得組"
disposableIncome %>%
.[-c(44:49),] -> disposableIncome
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(size = 18, hjust = 0.5)
) -> amswer
##也許可以用微分表示變化速度??
answer
library(readr)
disposableIncome <- read_csv("https://www.dropbox.com/s/z80sbjw94cjex8x/disposableIncome.csv?dl=1",
locale = locale(encoding = "BIG5"), skip = 4)
library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)
colnames(disposableIncome)[[1]] <- "年份"
colnames(disposableIncome)[[3]] <- "最低所得組"
colnames(disposableIncome)[[4]] <- "次低所得組"
colnames(disposableIncome)[[5]] <- "中間所得組"
colnames(disposableIncome)[[6]] <- "次高所得組"
colnames(disposableIncome)[[7]] <- "最高所得組"
disposableIncome %>%
.[-c(44:49),] -> disposableIncome
as.numeric(disposableIncome$年份) ->
disposableIncome$年份
disposableIncome %>%
filter(年份 >= 2003) %>%
gather(
-1,
key = "組別", value = "可支配所得"
) %>%
ggplot() +
geom_line(
aes(x=年份, y=可支配所得, color = 組別)
) +
scale_y_continuous(
breaks = c(500000,1000000,1500000,2000000),
labels = c("50萬","100萬","150萬","200萬")
) +
scale_color_discrete(breaks = c(
"平均每戶可支配所得",
"最高所得組",
"次高所得組",
"中間所得組",
"次低所得組",
"最低所得組")) +
labs(title = "不同家庭所得在金融海嘯後所得變動") +
theme(
plot.title = element_text(size = 18, hjust = 0.5)
) -> answer
##也許可以用微分表示變化速度??
answer
library(dplyr); library(stringr); library(ggplot2); library(plotly); library(lubridate); library(readr); library(tidyr); library(showtext)
font_add("QYuan","cwTeXQYuan-Medium.ttf") # 新增字體
showtext_auto(enable=TRUE) #啟用字體
theme_set(theme_classic())
knitr::opts_chunk$set(out.width='80%', fig.asp=.75, fig.align='center', fig.showtext=T)
# 資料引入
disposableIncome <- read_csv("https://www.dropbox.com/s/z80sbjw94cjex8x/disposableIncome.csv?dl=1",
locale = locale(encoding = "BIG5"), skip = 4)
# 資料處理
colnames(disposableIncome)[-2] <- c("年份","最低所得組","次低所得組","中間所得組","次高所得組","最高所得組")
disposableIncome <- slice(disposableIncome,28:43)
disposableIncome[[1]] <- as.numeric(disposableIncome[[1]])
disposableIncome_percent <-disposableIncome
for (i in 2:7) {
disposableIncome_percent[[i]]<-
disposableIncome_percent[[i]]/disposableIncome_percent[[1,i]]
}
# 作圖用資料物件生成
graphData <- list()
graphData$disposableIncome <- disposableIncome
graphData$disposableIncome_percent <- disposableIncome_percent
graphData$disposableIncome %>%
gather(contains("所得"),key = "可支配所得按戶數五等分位組", value = "所得") %>%
ggplot(aes(x=年份,y=所得, color = 可支配所得按戶數五等分位組)) +
geom_line(size=1) +
scale_colour_hue(l = 85, c = 70,h = c(0, 180))
graphData$disposableIncome_percent %>%
gather(contains("所得"),key = "可支配所得按戶數五等分位組", value = "所得") %>%
ggplot(aes(x=年份,y=所得, color = 可支配所得按戶數五等分位組)) +
geom_line(size=1) +
scale_colour_hue(l = 80, c = 75)
graphData$disposableIncome %>%
gather(contains("所得"),key = "可支配所得按戶數五等分位組", value = "所得") %>%
ggplot(aes(x=年份,y=所得, color = 可支配所得按戶數五等分位組)) +
geom_line(size=1) +
scale_colour_hue(l = 85, c = 70,h = c(0, 180))
graphData$disposableIncome_percent %>%
gather(contains("所得"),key = "可支配所得按戶數五等分位組", value = "所得") %>%
ggplot(aes(x=年份,y=所得, color = 可支配所得按戶數五等分位組)) +
geom_line(size=1) +
scale_colour_hue(l = 80, c = 75)
View(disposableIncome_percent)
